goals=sum(shot.outcome.name="Goal", na.rm = TRUE))
Matches <- FreeMatches(Comp)
View(Matches)
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2005/2006")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
source('~/.active-rstudio-document', echo=TRUE)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE))
View(shots_goals)
View(shots_goals)
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
View(Matches)
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2009/2010")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE))
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
library(tidyerse)
install.packages('tidyverse')
library(tidyerse)
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2009/2010")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
View(Matches)
library(tidyverse)
library(StatsBombR)
library(tidyverse)
library(StatsBombR)
shots_goals = StatsBombData
group_by(team.name)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE))
View(shots_goals)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
View(shots_goals)
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
player_shots = StatsBombData %>%
group_by(player.name, player.id) %>%
summarise(shots = sum(type.name=="Shot",na.rm=TRUE))
player_minutes = get.minutesplayed(StatsBombData)
player_minutes = player_minutes %>%
group_by(player.id) %>%
summarise(minutes=sum(MinutesPlayed))
player_shots = left_join(player_shots, player_minutes)
player_shots = player_shots %>% mutate(nineties=minutes/90)
player_shots = player_shots %>% mutate(shots_per90=shots/nineties)
View(player_minutes)
View(player_shots)
View(player_shots)
devtools::install_github("FCrSTATS/SBpitch")
library(SBpitch)
passes = messidata %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2009/2010")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
player_shots = StatsBombData %>%
group_by(player.name, player.id) %>%
summarise(shots = sum(type.name=="Shot",na.rm=TRUE))
player_minutes = get.minutesplayed(StatsBombData)
player_minutes = player_minutes %>%
group_by(player.id) %>%
summarise(minutes=sum(MinutesPlayed))
player_shots = left_join(player_shots, player_minutes)
player_shots = player_shots %>% mutate(nineties=minutes/90)
player_shots = player_shots %>% mutate(shots_per90=shots/nineties)
library(SBpitch)
passes = StatsBombData %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
create_Pitch() +
geom_segment(data=passes, aes(x=location.x,y=location.y),
lineend="round", size=0.6, arrow=arrow(length=unit(0.08, "inches"))) +
labs(title="Lionel Messi, Completed Box Passes",subtitle="La Liga 2009/2010") +
coord_fixed(ratio=105/100)
library(SBpitch)
passes = StatsBombData %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
create_Pitch() +
geom_segment(data=passes, aes(x=location.x,y=location.y,
xend=pass.end_location.x, yend=pass.end_location.y),
lineend="round", size=0.6, arrow=arrow(length=unit(0.08, "inches"))) +
labs(title="Lionel Messi, Completed Box Passes",subtitle="La Liga 2009/2010") +
coord_fixed(ratio=105/100)
install.packages(c("ggplot2", "tidyverse"))
library(tidyverse)
library(StatsBombR)
install.packages('devtools')
devtools::install_github('statsbomb/StatsBombR')
devtools::install_github('statsbomb/StatsBombR')
devtools::install_github('statsbomb/StatsBombR')
install.packages('curl')
install.packages("curl")
devtools::install_github('statsbomb/StatsBombR')
devtools::install_github('statsbomb/StatsBombR')
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2009/2010")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
player_shots = StatsBombData %>%
group_by(player.name, player.id) %>%
summarise(shots = sum(type.name=="Shot",na.rm=TRUE))
player_minutes = get.minutesplayed(StatsBombData)
player_minutes = player_minutes %>%
group_by(player.id) %>%
summarise(minutes=sum(MinutesPlayed))
player_shots = left_join(player_shots, player_minutes)
player_shots = player_shots %>% mutate(nineties=minutes/90)
player_shots = player_shots %>% mutate(shots_per90=shots/nineties)
library(SBpitch)
devtools::install_github("FCrSTATS/SBpitch")
library(SBpitch)
passes = StatsBombData %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
create_Pitch() +
geom_segment(data=passes, aes(x=location.x,y=location.y,
xend=pass.end_location.x, yend=pass.end_location.y),
lineend="round", size=0.6, arrow=arrow(length=unit(0.08, "inches"))) +
labs(title="Lionel Messi, Completed Box Passes",subtitle="La Liga 2009/2010") +
coord_fixed(ratio=105/100)
View(player_shots)
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2009/2010")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
font_import()
windowsFonts()
install.packages('extraFont')
install.packages('extrafont')
library(extrafont)
font_import()
library(extrafont)
font_import()
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
windowsFonts()
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11 & season_name == "2009/2010")
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
shots_goals = StatsBombData %>%
group_by(team.name) %>%
summarise(shots=sum(type.name == "Shot", na.rm = TRUE)/n_distinct(match_id),
goals=sum(shot.outcome.name=="Goal", na.rm = TRUE)/n_distinct(match_id))
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
extrafont::loadfonts(device="win")
library(ggplot2)
ggplot(data=shots_goals, aes(x=reorder(team.name, shots),
y=shots)) +
geom_bar(stat="identity",width = 0.5) +
labs(y="Shots") +
theme(axis.title.y = element_blank()) +
scale_y_continuous(expand=c(0,0)) +
coord_flip() +
theme_SB()
player_shots = StatsBombData %>%
group_by(player.name, player.id) %>%
summarise(shots = sum(type.name=="Shot",na.rm=TRUE))
player_minutes = get.minutesplayed(StatsBombData)
player_minutes = player_minutes %>%
group_by(player.id) %>%
summarise(minutes=sum(MinutesPlayed))
player_shots = left_join(player_shots, player_minutes)
player_shots = player_shots %>% mutate(nineties=minutes/90)
player_shots = player_shots %>% mutate(shots_per90=shots/nineties)
library(SBpitch)
passes = StatsBombData %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
create_Pitch() +
geom_segment(data=passes, aes(x=location.x,y=location.y,
xend=pass.end_location.x, yend=pass.end_location.y),
lineend="round", size=0.6, arrow=arrow(length=unit(0.08, "inches"))) +
labs(title="Lionel Messi, Completed Box Passes",subtitle="La Liga 2009/2010") +
coord_fixed(ratio=105/100)
library(SBpitch)
passes = StatsBombData %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
create_Pitch() +
geom_segment(data=passes, aes(x=location.x,y=location.y,
xend=pass.end_location.x, yend=pass.end_location.y),
lineend="round", size=0.6, arrow=arrow(length=unit(0.08, "inches"))) +
labs(title="Lionel Messi, Completed Box Passes",subtitle="La Liga 2009/2010") +
coord_fixed(ratio=105/100) + themeSB()
library(SBpitch)
passes = StatsBombData %>%
filter(type.name=="Pass" & is.na(pass.type.name) & player.id==5503) %>%
filter(pass.end_location.x>=102 & pass.end_location.y<=62 & pass.end_location.y>=18)
create_Pitch() +
geom_segment(data=passes, aes(x=location.x,y=location.y,
xend=pass.end_location.x, yend=pass.end_location.y),
lineend="round", size=0.6, arrow=arrow(length=unit(0.08, "inches"))) +
labs(title="Lionel Messi, Completed Box Passes",subtitle="La Liga 2009/2010") +
coord_fixed(ratio=105/100) + theme_SB()
library(tidyverse)
library(StatsBombR)
Comp <- FreeCompetitions() %>%
filter(competition_id == 11)
Matches <- FreeMatches(Comp)
StatsBombData <- StatsBombFreeEvents(MatchesDF = Matches, Parallel = T)
StatsBombData = allclean(StatsBombData)
View(StatsBombData)
View(Matches)
View(Matches)
View(StatsBombData)
ls()
vars <- c('mpg','hp', 'wt')
head(mtcars[vars])
summary(mtcars[vars])
mystats <- function(x, na.omit=FALSE) {
if(na.omit)
x <- x[!is.na(x)]
m <- mean(x)
n <- length(x)
s <- sd(x)
skew <- sum((x-m)^3/s^3)/n
kurt <- sum((x-m)^4/s^4)/n - 33
return(c(n=n, mean=m, stdev=s, skew=skew, kurtosis=kurt))
}
sapply(mtcars[vars], mystats)
mystats <- function(x, na.omit=FALSE) {
if(na.omit)
x <- x[!is.na(x)]
m <- mean(x)
n <- length(x)
s <- sd(x)
skew <- sum((x-m)^3/s^3)/n
kurt <- sum((x-m)^4/s^4)/n - 3
return(c(n=n, mean=m, stdev=s, skew=skew, kurtosis=kurt))
}
sapply(mtcars[vars], mystats)
library(Hmisc)
describe(mtcars[vars])
library(pastecs)
library(psych)
describe(mtcars[vars])
aggregate(mtcars[vars], by=list(am=mtcars$am), mean)
aggregate(mtcars[vars], by=list(am=mtcars$am), sd)
dstats <- function(x) (c(mean=mean(x), sd=sd(x)))
by(mtcars[vars], mtcars$am, dstats)
describe.by(mtcars[vars], mtcars$am)
describeBy(mtcars[vars], mtcars$am)
library(vcd)
head(arthritis)
head(Arthritis)
mytable <- with(Arthritis, table(Improved))
mytable
?with
mytable1 <- with(Arthritis, table(Treatment))
mytable1
prop.table(mytable)
prop.table(mytable1)
prop.table(mytable1) * 100
search()
source('~/R/learning-stats-w-r/data/scripts/mortgage.R', echo=TRUE)
dbinom(4,20,1.6)
dbinom(4,20,1/6)
dbinom(1,1,1/2)
dbinom(1,2,1/2)
dbinom(2,2,1/2)
normal.a <- rnorm(n=1000, mean=0, std=1)
normal.a <- rnorm(n=1000, mean=0, sd=1)
print(normal.a)
hist(normal.a)
normal.b <- rnorm(n=1000)
normal.c <- rnorm(n=1000)
chi.sq.3 <- (normal.a)^2 + (normal.b)^2 + (normal.c)^2
hist(chi.sq.3)
scaled.chi.sq.3 <- chi.sq.3 / 3
normal.d <- rnorm(n=1000)
t.3 <- normal.d / sqrt(scaled.chi.sq.3)
hist(t.3)
chi.sq.20 <- rchisq(1000,20)
scaled.ch.sq.20 <- chi.sq.20 / 20
F.3.20 <- scaled.chi.sq.3
hist(F.3.20)
exp(.5) / (1 + exp(.5))
exp(-.5) / (1 + exp(-.5))
?scan
library(lslr)
library(lsr)
mean(c(3,5,6,7,9,6,8))
median(c(1,2,4,6,4))
mean(c(8,10,8,5,4,7,5,10,8))
median(c(1,2,10,6,4,4,6,3,1,4))
mean(c(8,1,2,6,1,4))
median(c(8,10,8,5,4,7,5,10,8))
mean(c(9,10,6,5,6))
median(c(9,10,6,5,6))
mean(c(1,2,4,6,4))
median(c(3,5,6,7,9,6,8))
IQR(5,7,5,1,1,9,4,5,3,4,6)
IQR(c(5,7,5,1,1,9,4,5,3,4,6))
prob = c(18,16,15,15,16)
sol = sd(prob)*(sqrt((length(prob)-1)/length(prob)))
print(sol)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
rasch <- function(theta, b) {
1/(1 + exp(-1 * (theta - b)))
}
param2 <- function(theta, a, b) {
p_at_theta <- 1/(1+exp(-a * (theta -  b)))
}
param3 <- function(theta, a, b, c) {
c + ((1-c)/(1 + exp(-a * (theta - b))))
}
param3(0, 1, 0, 0)
param3(1, 1, 0, 0)
param3(0, .5, .41983, .2)
param3(1, .5, .41983, .2)
param3(1, .5, .79983, .2)
param3(0, .5, .79983, .2)
1 - param3(0, .5, .79983, .2)
param3(0, 1.7, -1, .10204)
param3(1, 1.7, -1, .10204)
rasch <- function(theta, b) {
1/(1 + exp(-1 * (theta - b)))
}
param2 <- function(theta, a, b) {
p_at_theta <- 1/(1+exp(-a * (theta -  b)))
}
param3 <- function(theta, a, b, c) {
c + ((1-c)/(1 + exp(-a * (theta - b))))
}
param3(-2.0, 1.76, -1.60, 0.20)
param3(-1.0, 1.76, -1.60, 0.20)
param3(0, 1.76, -1.60, 0.20)
param3(1.0, 1.76, -1.60, 0.20)
param3(2.0, 1.76, -1.60, 0.20)
param3(-2.0, 2.13, 1.12, 0.25)
param3(-1.0, 2.13, 1.12, 0.25)
param3(0.0, 2.13, 1.12, 0.25)
param3(1.0, 2.13, 1.12, 0.25)
param3(2.0, 2.13, 1.12, 0.25)
rasch <- function(theta, b) {
1/(1 + exp(-1 * (theta - b)))
}
param2 <- function(theta, a, b) {
p_at_theta <- 1/(1+exp(-a * (theta -  b)))
}
param3 <- function(theta, a, b, c) {
c + ((1-c)/(1 + exp(-a * (theta - b))))
}
param3(-2,1.3,0.5,0.2)
param3(-1,1.3,0.5,0.2)
param3(0,1.3,0.5,0.2)
param3(1,1.3,0.5,0.2)
param3(2,1.3,0.5,0.2)
setwd("C:/Users/isaac/sb/sb-capstone2/data/raw")
source('C:/Users/isaac/sb/sb-capstone2/data/raw/student-merge.R', echo=TRUE)
?merge
View(d1)
View(d1)
View(d2)
View(d3)
